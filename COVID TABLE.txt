--PRINTING OUT THE TWO DATA SETS COVID DEATHS AND COVID VACINATIONS 
select * from "Covid_death" LIMIT 200
select * from "Covid_vacinations"

--SELECTING THE IMPORTANT COLUMNS IN THE TABLES

SELECT LOCATION, DATE, TOTAL_CASES, NEW_CASES,TOTAL_DEATHS,POPULATION FROM "Covid_death"
ORDER BY 1,2

--CALCULATE THE TOATL CASES AND TOTAL DEATHS FOR EACH COUNTIRES COVID 19 INFECTION WERE REPORTED

SELECT LOCATION, POPULATION, SUM(NEW_CASES) AS "TOTAL CASES REPORTED", SUM(NEW_DEATHS) AS "TOTAL DEATHS DOCUMENTED"
FROM "Covid_death" GROUP BY LOCATION, POPULATION
ORDER BY LOCATION 

--A QUERY TO RANK THE COUNTIRES WITH THE HIGHEST INFECTIONS

SELECT LOCATION, SUM(NEW_CASES)AS "TOTAL CASES REPORTED", 
SUM(NEW_DEATHS) AS "TOTAL DEATHS DOCUMENTED" FROM "Covid_death" WHERE CONTINENT IS NOT NULL
GROUP BY LOCATION 
ORDER BY "TOTAL CASES REPORTED" DESC, "TOTAL DEATHS DOCUMENTED" DESC

--OR

SELECT LOCATION, MAX(TOTAL_CASES)AS "TOTAL CASES REPORTED", 
MAX(TOTAL_DEATHS) AS "TOTAL DEATHS DOCUMENTED" FROM "Covid_death" WHERE CONTINENT IS NOT NULL
GROUP BY LOCATION 
ORDER BY "TOTAL CASES REPORTED" DESC, "TOTAL DEATHS DOCUMENTED" DESC

--A QUERY TO SELECT THE EACH CONTITNENT TOTAL COVID CASES AND DEATH 

SELECT DISTINCT CONTINENT,SUM(POPULATION) AS "TOTAL POPULATION PER CONTINENT",
SUM(NEW_CASES) AS "TOTAL CASES REPORTED", 
SUM(NEW_DEATHS) AS "TOTAL DEATHS DOCUMENTED", 
SUM(NEW_DEATHS)/SUM(NEW_CASES)  || '%' AS "POSITIVE CASE TO DEATH % " 
FROM "Covid_death" WHERE CONTINENT IS NOT NULL GROUP BY CONTINENT
ORDER BY CONTINENT ,"POSITIVE CASE TO DEATH % " DESC

/*LOOKING AT THE TOTAL CASES TO DEATH PERCENTAGE FOR EACH COUNTRY THAT REPORTED
A COVID 19 POSITIVE CASE*/.

SELECT LOCATION, POPULATION, SUM(NEW_CASES) AS "TOTAL CASES REPORTED", 
SUM(NEW_DEATHS) AS "TOTAL DEATHS DOCUMENTED", 
SUM(NEW_DEATHS)/SUM(NEW_CASES)  || '%' AS "POSITIVE CASE TO DEATH % " 
FROM "Covid_death" GROUP BY LOCATION, POPULATION
ORDER BY  "POSITIVE CASE TO DEATH % " DESC

--A QUERY TO SHOW THE DEADLIEST DAYS GLOBALLY SINCE THE PANDEMIC BEGUN

--THE DAY WITH THE HIGHEST NUMBER OF COVID DEATHS GLOBALLY 

SELECT DATE,SUM(NEW_CASES) AS "TOTAL CASES REPORTED", SUM(NEW_DEATHS) AS "TOTAL DEATHS DOCUMENTED"
FROM "Covid_death" GROUP BY DATE ORDER BY  "TOTAL DEATHS DOCUMENTED"
DESC

--HIGHEST NUMBER OF COVID INFECTIONS AND DEATHS GLOBALLY  

SELECT DATE,SUM(NEW_CASES) AS "TOTAL CASES REPORTED", SUM(NEW_DEATHS) AS C
FROM "Covid_death" GROUP BY DATE ORDER BY "TOTAL CASES REPORTED" DESC,  "TOTAL DEATHS DOCUMENTED"
DESC

--JOINING BOTH TABLES (COVID DEATH AND COVID VACCINE) 

SELECT * FROM PUBLIC."Covid_death" DEATH JOIN PUBLIC."Covid_vacinations" VACCINE 
ON DEATH.LOCATION = VACCINE.LOCATION AND DEATH.DATE = VACCINE.DATE LIMIT 100 

-- A QUERY TO DISPLAY CONTINENT, POPULATION, LOCATION AND TOTAL VACCINATIONS, TOTAL FULLY VAXXED POPULATIONS
--AND TOTAL BOOSTER SHOTS TAKEN

SELECT DEATH.CONTINENT,DEATH.LOCATION,DEATH.POPULATION AS "TOTAL POPULATION",
MAX (VACCINE.TOTAL_VACCINATIONS) AS "TOTAL VACCINATIONS", 
MAX(VACCINE.people_fully_vaccinated) AS "TOTAL FULLY VACCINATED" ,
MAX(VACCINE.total_boosters) "TOTAL BOOSTERS TAKEN"
FROM PUBLIC."Covid_death" DEATH JOIN PUBLIC."Covid_vacinations" VACCINE 
ON DEATH.LOCATION = VACCINE.LOCATION AND DEATH.DATE = VACCINE.DATE 
WHERE DEATH.CONTINENT IS NOT NULL GROUP BY DEATH.CONTINENT, DEATH.LOCATION,DEATH.POPULATION  
ORDER BY "TOTAL VACCINATIONS" DESC
